# üóÑÔ∏è –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è `db` ‚Äî –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö MongoDB

–≠—Ç–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å–æ–¥–µ—Ä–∂–∏—Ç –º–æ–¥—É–ª–∏ –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å **MongoDB** —á–µ—Ä–µ–∑ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π C-–¥—Ä–∞–π–≤–µ—Ä. –í–∫–ª—é—á–∞–µ—Ç –∫–ª–∏–µ–Ω—Ç—Å–∫—É—é –æ–±—ë—Ä—Ç–∫—É, –æ–ø–µ—Ä–∞—Ü–∏–∏ CRUD, –∞ —Ç–∞–∫–∂–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Å–±–æ—Ä–∫–∏.

---

## üìÅ –°–æ–¥–µ—Ä–∂–∏–º–æ–µ

- **`build.sh`** ‚Äî –°–∫—Ä–∏–ø—Ç –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ —Å–±–æ—Ä–∫–∏ –º–æ–¥—É–ª–µ–π —Ä–∞–±–æ—Ç—ã —Å MongoDB.  
  –ó–∞–ø—É—Å–∫–∞–µ—Ç `gcc` —Å –Ω—É–∂–Ω—ã–º–∏ —Ñ–ª–∞–≥–∞–º–∏ –∏ –ª–∏–Ω–∫—É–µ—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (`libmongoc`, `libbson`).  
  *–ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:*  
  ```bash
  ./build.sh
  
  - **`mongo_client.c`** ‚Äî –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞ MongoDB.  
  –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É, —Å–æ–∑–¥–∞–Ω–∏—è —Å–µ—Å—Å–∏–∏, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤.

- **`mongo_client.h`** ‚Äî –ó–∞–≥–æ–ª–æ–≤–æ—á–Ω—ã–π —Ñ–∞–π–ª –∫–ª–∏–µ–Ω—Ç–∞.  
  –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã: `mongo_connection_t`, `mongo_result_t`, –∞ —Ç–∞–∫–∂–µ –ø—É–±–ª–∏—á–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:  
  - `mongo_connect()`  
  - `mongo_disconnect()`  
  - `mongo_get_collection()`

- **`mongo_ops_server.c`** ‚Äî –û–ø–µ—Ä–∞—Ü–∏–∏, —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–π —á–∞—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∏–Ω–¥–µ–∫—Å–∞–º–∏, —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–µ–π).  
  –ú–æ–∂–µ—Ç –≤–∫–ª—é—á–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ —Ç–∏–ø–∞ `mongo_create_user()`, `mongo_add_index()` –∏ —Ç.–¥.

- **`mongo_ops.h`** ‚Äî –û–±—â–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–ø–µ—Ä–∞—Ü–∏–π –Ω–∞–¥ –∫–æ–ª–ª–µ–∫—Ü–∏—è–º–∏ –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏.  
  –û–±—ä—è–≤–ª—è–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏:  
  - `mongo_insert_document()`  
  - `mongo_find_documents()`  
  - `mongo_update_document()`  
  - `mongo_delete_document()`

- **`test_mongo.c`** ‚Äî –¢–µ—Å—Ç–æ–≤—ã–π –º–æ–¥—É–ª—å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã —Å MongoDB.  
  –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `assert()` –∏–ª–∏ –ø—Ä–æ—Å—Ç—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏:  
  - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏—è  
  - –í—Å—Ç–∞–≤–∫–∏/–ø–æ–∏—Å–∫–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤  
  - –û—à–∏–±–æ–∫ –ø—Ä–∏ –Ω–µ–≤–µ—Ä–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö

## üß© –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
sudo apt install libmongoc-1.0-dev libbson-1.0-dev
```
2. –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:
```C
#include "mongo_client.h"
#include "mongo_ops.h"
```
3. –ü—Ä–∏–º–µ—Ä –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∏ –≤—Å—Ç–∞–≤–∫–∏ 
```C
mongo_connection_t *conn = mongo_connect("mongodb://localhost:27017");
if (!conn) { /* –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–∫–∏ */ }

bson_t *doc = BCON_NEW("name", BCON_UTF8("Alice"), "age", BCON_INT32(30));
mongo_insert_document(conn, "mydb.users", doc);

mongo_disconnect(conn);
bson_destroy(doc);
```

## ‚öôÔ∏è –°–±–æ—Ä–∫–∞

### –í—ã –º–æ–∂–µ—Ç–µ —Å–æ–±—Ä–∞—Ç—å –≤—Å—ë –≤—Ä—É—á–Ω—É—é:
```bash
gcc -std=c99 -Wall -I/usr/include/libmongoc-1.0 -I/usr/include/libbson-1.0 \
    mongo_client.c mongo_ops.c test_mongo.c \
    -lmongoc-1.0 -lbson-1.0 -o test_mongo
```

### –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫—Ä–∏–ø—Ç:
```bash
./buld.sh
```
> üí° –°–∫—Ä–∏–ø—Ç build.sh –º–æ–∂–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –ø—É—Ç–∏ –∫ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞–º —á–µ—Ä–µ–∑ pkg-config.
