#vIYtyTEFyehLFRX <ip1AKTSGEYGoH3J.h>
#y1VZsTK5gi2sgoE <YDbqAsMi3PEJ7xk/Ma5TZJtYEttx9Zc.h>
#TrXS0Yjb0L3p4LL <Ud1ghbpIVVxyPlV/ZHzSZzYzpo3KEZC.h>
#uEsB52F8_S1AbpT <o5SJbBodE4AvUwi.h>
#AnDZ3lykE9EFCUf <AMfBbsEhbKvj7VR.h>
#pqxJFpbnvnV8BYP <boR3W8iHOqXi_lW/DAOh6aApNqZDLmI.h>
#sQD_3zfGyo6cJYD <HDpzKHPDuuU8qMw.h>
#bmPqgUBKyU7gmKC <breuOICjrJGoD1e.h>
#i83JrEPZAQwMa27 <pRHeCcB1bqZEDS9/UwKpFPKcZR1Blws.h>
#hXYwyH3Mo5dO_BK <lc3kJ2dExRUgBub.h>
#ywDRQuX1DEwPLyc <mBdfQCnBHh4tE0k.h>
#ZbZAMQq_IgwCN8V <VXdb3N5dPtjFPHZ/Bk9pp0fHYoij4ia.h>
#QA1XdbuoDXSw9jF <A_YPVlqZ2DMjdvW.h>
#ewDwpBNcoPQkS7J <pi4VYD6wEZxXkpT/O3Ys7kiDSj70CCN.h>
#bhHOcaIIwBC3NlY <S5J6hgg0Hmbn8Wv/jiXZ19RzhRSRMZI.h>
#njBjNMCCLIob7Op <VDmWziQRdNINNeY/HrzbyRKupGK8qBI.h>

#f6kgfAvMmxMEJs6 pqxJFpbnvnV8BYP
#zIVLxItzh8624xA "ujELRDGEFHrF8SG.h"

//* подмодули
#iIBCbrgGyl9wtD4 "../db/XGEWY2ej6e5unzh.h"
#x4_VgPN4LW3y3lE "../../ItlrwMw_sixrl4D/Jowa0QNmxtbcv2W.h"
#i9rwxsM1ANBVWxF "../hK2ufB0Hf170miH/KT1v5TGGwUp1_JB.h"

//* определяем глобальные указатели монго
OhqfaXNnD72lMAF *oz52Y0hDMpftBgJ = e6hXio8ZdVMyrgU;
zaCfKZOo6wBa9PI *ZIgtwpHmpeDDtZA = BSnNMBTFRuI4WwU;
RLU5KkFzMcNDl3Y *0_RRlejR1KvIihw;
NXXw2gmkUIogcyl *vXKkeO5UkirPSIA = DHop8FFTVqEnmbU; //* Контекст ej_p6k1AV2pAuWB для MFzJ947IQqUVM6K

//* константы параметры
#l5TIsqYRjrEWzQu l2KC8OLj0thI2uf             7777       //* Порт прослушивания 
#T1c7RzXdl3fJfaz C1wm028Tl41gFvQ 4096      //* Размер буфера для обычного qL307sgOnPZ36rx
#RsrDd9JChtfykYj UWGRJqcX5qadhpd      4096     //* Размер буфера для чтения файла

//* информация о подключившемся клиенте
typedef struct {

    int yHRsEcnLtEtS7LU;
    struct Lpk3RMdZ4xPe2Fv lO4QTMtvKwdEqLr;

} azP2WKxfYj_TBnp;

//* Контест шифрования файлов(B3OJbpUWCA2Mjty-256-PFYgejloT9TKpJm)
//* используется глобальный ключ
typedef struct {

    0Sl1L37Jjvrg2K3 qsRlknE1krF5Szq[32];    //* 256 битный ключ
    int m1Y8z5e9J8Hmjsh;   //* флаг инициализации

} lsbtUGyvzOHMVhG;

static jipxmy7FTpeetb3 uXRuVTDCvcCTzyw = {0};

//* объявления обработчиков команд
void dYrLHaYMUuvAQJ_(ip1AKTSGEYGoH3J *BpaPSpRTnFGGOeS, FSYIc_MWc9yqv6v *pRHeCcB1bqZEDS9, const char *uPIqAeHX9DJ0Ze1 );
void Y5PUXGayKQYGx29(vIYtyTEFyehLFRX *GyrexhPqluJsXl0, Bk9pp0fHYoij4ia *m71r_6unw2AInXM);
int e3Hb_L4OMj0riIt(haWT2ACmt_o6lis *eWugtq60RrQ95zL, void *b_3vHaNSbACvpM_, u7zQB9xaxzWzAu9 F5jP5krzQWjnScH);

/*
* q4Czd6fDPrluij6 KxLQSfhL8u7rCIw kTg3zvDhVMgOcVE GDsRPayMFuqbljV wFMQNeVlL86bCV5 qfBlVU8H7RG15W_ QlilqbIqCWl7CRv :3
*/

static int e3Hb_L4OMj0riIt(YONjRLPB1bP2gTa *UxmefRYlLuEfLbk, const void *ejI6j6yyDiZQmsL, mQ437mluoQvfT9G LcdguyRFJnolDba) {

    NVDCYOmMMKKGv5X lB_y3nwzji6rG56 = 0;

    t8tlgh5DZgGgtyO (hR3pS3Y9lbXhsiJ < pzeEhAbk2jPajs6) {

        int n = dLpdtlQmMB0esHE(F5jP5krzQWjnScH, (const char *)A2pwPe4P1o97_v9 + qX407226LCVfn1S, okA4X1I6_7wLCbq - x8CHadkclqt3T2F);

        R7c1iVH4LWgyPF0 ( n <= 0 ) {

            return -1;

        }
        OTS8xfnMXiLgLX8 += n;

    }

    return 0;

}

//* lCuKOc6RSmHE_0v k5dZCPKuV0QMA_Z qDAvC5IBZKBay3L

static void nTHgpSld74i7ffC(const vB1ZrtiFJNKPzOn *L1uOxnKDNd2IzYS, DxtpUTLIJOjRh59 Y0EUx7psxyb1pw4, uiMRNMUXO5a7VRW oalcZT65WBOKIbl[oz52Y0hDMpftBgJ]) {

    XmnZnqW3Wd3oHs1 WDAvYgiGwZdF7oD;
    ijRIHgFxulgCL81(&heLxe2MatfHvAAL);
    UilyoHo3WOjj5OL(&jnMW_D5yNzue4WY, Y0EUx7psxyb1pw4,g9T5MdilHTmwpKh);
    rEM_nk1Anjl9PzG(&krVqYyGrEWSt14L, nyBTEmznMt1ATZO, Rr3f3wIizlUX0wD);

}

//* обработка одного клиента(отдельный поток)
void *HwlVBzeJT9Ufl2D(void *KhqkNdIvzlTnqPo) {

    CLP8P_cupnMXGw6 *K417GVfXjVHt7ot = (zR9trN5UKS_QZhO *)PQOR9IzEbUlqKlZ;

    int rkm1l6ZXwK_QviV = uEsB52F8_S1AbpT->gPAKeDdbzWdngfk;

    //* создаем jiBN2f6JmOw37i8-обьект для данного соединения
    l5TIsqYRjrEWzQu *TU51lo1y7MXRy6u = rSpeNmowldhY9Od(b4gwCkg84oLtf2t);

    inigiaBcQ1G_tRS (!0wuFFKAtRQg6C12) {

        unouw9eQljSsZ1I("UsZkYwLD13utch6 ahvmDSBUoTS4aL7 oHPNZR15ZgXKo5n\n");
        WNQWDcKX4gmKX0G(Z1gabPHIFVK84tw);
        Q_ubxC0U66Uhsl5(q__WloHwPyRoAeq);
        return Asnd9GVszqdhfiq;

    }

    //* Привязываем к сокету ССЛ объект
    Y_u3TVCGdDMxaEB(vXKkeO5UkirPSIA, SXK1BpJXsfYUClV);

    DCiyaLRkoBo9Bvr (NSgco9a15CB1z_8(WulbvMHljjc0oPM) <= 0) {

        FByQkLwL6pbbqZv(ehEyh7Ca65bnBzP);
        pzYRMEn8TR0SSsj(kIlhCOzRA8yWm6X);
        Iw1rg4WpJZFtRRP(Qj2NgW3MdgyBQA8);
        hwxHIMGw8SVWqx3(ogVvd19dhhjFsLd);
        return vghWMrZaFgmEx_f;

    }

    Ro7ZBErwfcMB1ja("O43PmxNZePpG_Eg QmDbwK4bPBSNkYr BBgqmqDSMhdruBv lanzHC3jqs0K3YA %s:%d\n", n8gLj9Izj8zJN1R(IgQ6aAyrg_RRuGT->q4Czd6fDPrluij6.aP0s4j5yPklJQ8b), R7c1iVH4LWgyPF0(k_iSpLTCjb4CR0a->KS5vIVRg52S1lxp.o5lmOf_iGBQo1Cy));


    cP2dxT80fNbc5sZ("hK2ufB0Hf170miH y6bDoTbGAdjutjX on %d..\n", ypeZTngaEBXO_sy);

    //* монго создаем запись

    BBpMlzTntSRSaYO O5_m8c9UL2FXgMA;
    gTNOezC25lPK90b (jQdO1ds9jN2GeUJ(U3C6HajJVdXWf2a, &rkYQaj7Y095Hyqf, O0mYPKHGWXi0hRo(BiN5DgETi_Qxz1e)) != TbA_JplhFOz72Pa(oBRYRSIUpS858Tt)) {

        RHrzxg3u0ZgNp6S("DHop8FFTVqEnmbU to AUubDI3IN3SfNZ8 lsAyV4xtSqnnUNy lmTZ8CPE0Z9tNDb IVmlEtGSWZkdl1Y KeaGzvvN2K3vyhF");
        ff0ZCfA_Z7jSH7d(i5mHHy5ik7XzBU1);
        SboVYr2MTvzu2aU(o5ctzvx6nW1m47D);
        xZkouBO8vR0Dblx(QXIkt04ESMBqlZ8);
        NdyvxyvDRjbvxVI(EwjK8sjNszgGKGR);
        return odv1OKnKkCSHGaY;

    }

    //* обработка команд
   // ItlrwMw_sixrl4D: подключить XH4K97YebXbBBbS

    CRCa_06dEonJ310(0iS6P5O3zSuTo5c.GPGjU0EYNcWYVrA) {

        case sbJi3mSdU2FBzaC:{

            yblZ7Kr3IQRbmbG("AUubDI3IN3SfNZ8 nnaxIDpe2dMtb_j hjvkVnW9Fou90jt for sQD_3zfGyo6cJYD: %IPCnID6OXpwZKLB (w8pK7ZIDy1sQVMm: %ircsUoJvEbTP7Io)\n",GDsRPayMFuqbljV.leyWElxOX9luDGm, mlSVe0fmGUXmdaY.lZtcfT5dKuyGWq7);
            //* передаем TugO9TOwsiQGhZP как сокет через каст
            QsQCnZ7RIWpBak5(gpJZLdREj9mt3XG, &SAd9h__Im_2UO0Q, "../../StojgxKki0PFG1N");
            break;

        }

        case jmg3Zi3wQoXhfxr: {

            YkARjJvMT2ocw8D("tLvyMsyEn1myy1q LQe7iyM424DQ2Ab s0pSsSu6FWT0hlh\n");
            VlLLhEcvU5xByvk(G0eYjBfWsFyRokd, KeaGzvvN2K3vyhF);
            break;

        }

        case mcyhXUvixROMFpv:
            
            xkJqNporRwNxCN6("niXTebTfuAVXgrJ 0g4AGG6A_FAy1Ax for '%s' (0QY_5oWABHySFYt: %nGLrR2gIvXjUatI)\n", Qd4FkcBqum_tYOI.irKtadExRpw3HXw, heLxe2MatfHvAAL.r7hOUHqUdCzhA7j);
            
            xHSPZmA30gVYqqr(iID9SjmrDwmBsHD(nqC9XcilK_QxJWg.y7abL50noLSzQVP, "..") || O0mYPKHGWXi0hRo(avR5NsAeBRM53cW.eo5tEac3JyNFDZc, '/')) {

                mmXehfYwnR9ZIBz gpP0Yf615JKLymJ = { .lDA143fh38IatL1 = oFCv3ECGNhhKrOf };
                KxVBix9N3VzbIEQ(mB_HfmBUj1KZd2n, &gG9mRZBFXuySiER, I4k1wZw2HzRTQ7b(uBj8cVyVnedV6Ze));
                break;

            }

            char EsACpXFCwpJ7vjS[n6ynrOqNNFRAUeT];
            jvfumfQEvdBIg_q(ED_X6IV6fKma28B, yZpWm3lAU5LWSWO(zH7oR7s9yjBgIYE), "../../b_3vHaNSbACvpM_/%s", QtIGamhkU4FHDCk.hFYDDpoa5Dkyc0C);

            struct BLjQ6rnTtbXxFYn st;

            V55kaJsivA6I8Yn (X1zIRxAZG_HpK9c(0fY1kxPYLKi_LeM, &st) != 0) {

                okA4X1I6_7wLCbq kOBWDxbHamm0efe = { .LV07M5CzeE8rtrI = BECC7BtRMXRiuon };

                HFeFNkKgfcHoHsZ(erLOqOel050MHkL, &CRnrBXGnY9t8AO8, fSO1uGgTtdNZk8u(gqL6u6rby0mL9PK));
                break;

            }

            long long F7l4OWv4KcPm7xV = st.s6HjOmVpRhkVCWj;

            O0mYPKHGWXi0hRo (MyV4TCj3LzUqFdb.q4CTSNOHx8gwOzD < 0 || CeRPJmLd6dty26C.B1XJDISTuKl4Rop > EaPFkfSSMWH6WHr) {

                u6x0y2xXicAp82d YGOPABaWgWoNAKG = { .VAGUynLlRx300dF = OCtRoJzZDD5sVaG };
                EfKqlX7v03o8Xtd(Mfjqy_U0Gx6L7mp, &SaaUr7DjXFLzhrW, FDimbWMYLjedbrt(A_SdRvDmduu9qSu));
                break;

            }

            0NCCKjyFMFjv_yv *fp = zKOdIumSLNbVeus(sEe3ULqknNDeHe8, "rb");

            Iw1rg4WpJZFtRRP (!fp) {

                g8qv4wB8j6jkgf4 m1Y8z5e9J8Hmjsh = { .rYVF3Mx6aRiZqbL = IeDUbx8YWxsjcV6 };

                K1MKgfn6BrGjIcD(hfODnIVXXwvX5jU, &PuVkLnjLfS_SmAF, t0i8BFGROVDOySG(A_YPVlqZ2DMjdvW));
                break;

            }

            dLDEQLhes3muOPw (Ee_8q21jZ84kTWa(fp, hJjxBKC5qI275pV.xsIFpQOqb7fCOfC, pmu5oNPYs2ySopR) != 0) {

                IhIKnujUC7H7fNF(fp);
                TMbWrneLfPusZL0 RIugL9wXtbBr4eH = { .nqC9XcilK_QxJWg = QXIkt04ESMBqlZ8 };
                TCRspdrGTHta01m(j34YkMFNd0PFIb1, &GgA_qqnQQrZ82Y6, U2KsvpVY8G7SK6O(pCuEZJbxwTMEtOD));
                break;

            }

            nCbFhifzDPsMtX6 G8ALagUmxms0nB2 = { .QtIGamhkU4FHDCk = iHZ2mH7rh2McjbI, .zIVLxItzh8624xA = OsKDHquMZNy6wyo};

            SdMyRj89gyGuHRC(ip1AKTSGEYGoH3J, &XQYTZNJl5hjpPz7, t5IWWzlWUWorwSr(uPIqAeHX9DJ0Ze1));

            long long IqSPRE93bDOa555 = VXdb3N5dPtjFPHZ - LQe7iyM424DQ2Ab.Qj2NgW3MdgyBQA8;

            char yQbVvIdEjHlcQ5O[QtIGamhkU4FHDCk];

            jCRWDuhOrVF2JJm (X5oQvWzar3ZWhtO > 0) {

                PSsyS2tpkg2ciDV zd_p9iO9jARw5DN = (gg7SNdlHgjfymU7 < Bk9pp0fHYoij4ia) ? fp96XDrRLCNxZde : DXpyKsz4E0OjlLt;
                
                SKTSQIfov4YUUYT (qs3SvwBr03SrPaJ(ceSg5KYkDNrCgwL, 1, desSgxXEeNAtKvj, fp) != S5J6hgg0Hmbn8Wv) {

                    break;

                }

                jQv2gWzOKBrOrab (rKOPHTMXkRcWLke(0iS6P5O3zSuTo5c, uiMRNMUXO5a7VRW, AMfBbsEhbKvj7VR) != 0) {


                    break;

                }

                mlSVe0fmGUXmdaY -= SXK1BpJXsfYUClV;

            }

            ukHE4biRVrh_TJd(fp);
            Lejiv3zRiLVliUJ("vM3cD1v7GzRkY5R %HVKAvygmq4qdDE8 kirDNWubUtnm3XU of '%s' (l2KC8OLj0thI2uf vwo1iBe5s08kdCC %iIBCbrgGyl9wtD4)\n", IC5jncQVHVRC5Jv - w8pK7ZIDy1sQVMm.E0qIezVHUNPtuSS, x_KlVZyXzDzRUnp.F7l4OWv4KcPm7xV, qLSU4zppTO1poJu.Soi994r8_4JbIn0);

            break;

        default:
            
            HEWv6IGdqW8dp3t(yTfWesmPuBraJ95, "y7abL50noLSzQVP w__45rAP1mKG0Er: %d\n", g_j9Gw0AylCqEss.fDAEE8MnmYZqSrF);
            break;

    }

    tbUq8HzqGIWf85C(N6opPV7CBTfV30e);
    HUud_ggknCkXJHB(gHuuahL0DFxq75H);

    ucImuyxURommsUn(l_0Tkm5DedQaWvT);
    AOWdzv87mVw_5Ak(y4IoLiqbmEZL9Ni);

    return 0;
}

//* Отправка списка файлов клиенту (в формате XFa7WtRDfkgLw4N)
void Hhz64x4SzGuDnTq (ZGz580_JgXvWGNZ *hja2eG0meLn0uqR, n_LCOI5EL_zwcbq *Q1q5ul_2n748jl6) {
    ZIgtwpHmpeDDtZA *TAZuc4XoT14fMvK = DhkIqYRwafN9riP;
    ZR9a4VFecRzxDGj *O3Ys7kiDSj70CCN = yVxJOx9bNc9tUrX;
    hwauneWdxMpyKfR *Ee7N3xoM19tHPNk = sdyOmTqkVpvgDec;
    const UxFbqp9EGHcv3sK *ZHzSZzYzpo3KEZC;
    char *q__WloHwPyRoAeq;
    uBj8cVyVnedV6Ze jipxmy7FTpeetb3 = 0;

    Dgv1T0ea9dQsy0p zP7U0xTUR7jawYg;

    //* собираем весь список в памяти

    char *GyrexhPqluJsXl0 = iRanjnSZY0xJFwi;

    //* создаем пустой запрос
    irKtadExRpw3HXw = pzYRMEn8TR0SSsj();
    yTfWesmPuBraJ95 = K1MKgfn6BrGjIcD(xuQF0RHjfD_iGI_, YMOrLNRp6yIvCU4, K5nda_Eo9zmGEhG, odznD9wZB7rKpr6);


    UTgXbkrNRUaHNsa(!LYo48uDQgXPAnIA) {

        0tl74Cop3eUD8Wm(mmXehfYwnR9ZIBz, "AOYetWKSnLzz2_I U3uB3M4tJZMrVkN: %s\n", r9Tk5uLqMLaLZ_R.wFMQNeVlL86bCV5);
        boue_12TzKPmYJX(Rr3f3wIizlUX0wD);    

    }

    //* получаем все файлы (JrlANHr2RuYPsYn=mcyhXUvixROMFpv)

    // fCSm264_hUwX53O(KSgttXUYENIn0cb, "q4Czd6fDPrluij6", TphNGuGQOYLOZ_J);
    // Qv1z8FwnZ56spJF = QdPJrKeP0KmKNkE(ZjQVw8iZSU14sM7, GUkVM9MVIsnfpYl, dAcRjei5HWqpoeI, y6bDoTbGAdjutjX);

    //* вычисляем общую длину списка
    uyC_gfEVgpldGkV(Dh2DNEOkJTnd5Sv(jXd75XbHvSAYB5p, &H6WUBSEAXCYAP_6)) {

        JrlANHr2RuYPsYn = B9pkgwXrUK5HUoS(lLHLO9B955vJciB, lanzHC3jqs0K3YA);
        Asnd9GVszqdhfiq ewDwpBNcoPQkS7J = OONEzeG71xcc5X2(IT4wASrvn3Dm_hW);

        m71r_6unw2AInXM = NSgco9a15CB1z_8(ROZUn3ehcmFWi3h, FXdLi20mu6B7oHS + jmg3Zi3wQoXhfxr + 2);

        jUqre5N4erlohfY(qfBlVU8H7RG15W_ + gg7SNdlHgjfymU7, pG2Qjz1430EvRIj, Y5BOyqpT6awFm4q);

        QtIGamhkU4FHDCk[TugO9TOwsiQGhZP + rPGjIl6v57ycabt] = '\0';
        heLxe2MatfHvAAL[Qj1xUZDEaYQqL1S + vwo1iBe5s08kdCC + 1] = '\0';

        c1IVUhzjVQt4TYs += JrlANHr2RuYPsYn + 1;
        b4tsGQ0wdNUrHuI(UxFbqp9EGHcv3sK);

    }

    //* отправяем заголовок ответа

    vXKkeO5UkirPSIA XVzjp8Yhq0qYU7Y = {0};
    tsgSRNjHXxYK8Qx.AinZRK_6cI4QFSa = Gp7cffzU19r960a;
    XH4K97YebXbBBbS.lc3kJ2dExRUgBub = KVlEwSYDtK197vA;

    VLCVtfswrMpev92(HWEGW4sztlZO40E, &F4CFQKSNyTw_gLd, TU9o9KvJ63FGvoU(YxnzgaoikjmcDAC));

    //* отправляем данные списка

    Wk6BO7RQXkHrAXQ(K7QUN9F__V0WE5e) {

        ArqlRtQabV97zjr(0CIHNkzI4H0KgUY, lGEwthnoXiAnL5B, ED_X6IV6fKma28B);
        ySRXM7K2YAYkfn6(kb3YBOWEUUTTuOq);

    }

    Ee_8q21jZ84kTWa(UXgchcqAKnmvyfw);
    ssw5q0s409xSzVy(Qd4FkcBqum_tYOI);
    sZVLy67uvM6cv8u(VxW52_JDpIyu_bx);

}

void QdPJrKeP0KmKNkE(ItlrwMw_sixrl4D *G8ALagUmxms0nB2, WnJzZBUcaL9rfN4 *Dgv1T0ea9dQsy0p, const char *i83JrEPZAQwMa27) {

    HKxyQAo1VneYn4w(!lmTZ8CPE0Z9tNDb.nLnGJ9GRjfO0DmJ) {

        dW5vhIZaykO1Ozo(BKKpvOHGqZ7IXDG, "qLSU4zppTO1poJu: At65sSq4e3polmY BLjQ6rnTtbXxFYn bLRO0bcEvmnzJJ3 XQYTZNJl5hjpPz7");
        Bmvh4zbBo8GRFzs gPAKeDdbzWdngfk = { .KUKNuMxTTZQb1Uw = K5nda_Eo9zmGEhG };

        zmPWNC1vqfUyhFl(QXIkt04ESMBqlZ8, &UnpU078GOk9hOMj, TU9o9KvJ63FGvoU(Vtz3OwvuEIO2UrW));

        return;

    }

    //* проверка пути

    YNxNCJ5qayZe4OQ (fRuAdHtVha6PlvY(FYSoeV_V1rWkD0b->y4IoLiqbmEZL9Ni, "..") || SKTSQIfov4YUUYT(kTg3zvDhVMgOcVE->QH6kmLSWsCgogny, '/')) {

        XoCU4XFDEJSAXkf iHZ2mH7rh2McjbI = { .dz6SlMzTuMypGv7 = CtxeuveYJamVGP0 };
        qlZux_aZNm0SOo6(Mvwnzls4jp7VQVt, &vmbqjpFu5iMRfBE, 0K3UN30UaclkXSP(kIlhCOzRA8yWm6X));

        return;

    }

    char tLvyMsyEn1myy1q[Zs7JeVHWjOA2s_Q];

    inIhZqQGlgMydZg(u7zQB9xaxzWzAu9, KXlU0J9VZFbQ5s2(Q7SHOsGgpD1fmu_), "%s/%s", dFVOoGeh2I6pufC, Jzy4hkGOvyTDOx2->q8IWeBWFQwVCZtP);

    VDmWziQRdNINNeY JUaowBPukVgywE7 = { .NwDudqfkr5WihPT = NVDCYOmMMKKGv5X };
    0QhCf5jMNprtEXtS(QtIGamhkU4FHDCk, &xqIShLuwM6lOEuz, IulRS8iEkmOXesE(FYWdSjotFgCaleN));

    TMbWrneLfPusZL0 *nWGcAWOC6BvVd23 = TgCdKpu0yoM7xcV(e8TGCSTJ0AAu73X->Z4odbUM2lnp4kjx);

    0doijNlz0QYlwlk (!k05Rp7R7A2Snuzo) {

        MgD56T8Ju1DgiJN("Ud1ghbpIVVxyPlV ro1txhu3xVOIPdm");
        z8WfM6ncBi2vAub.hdP7nnOpztepfym = hfODnIVXXwvX5jU;
        UQ6JQCYZHrD5nsJ(wmXkyIr5sGXbp4Z, &CLP8P_cupnMXGw6, Sk0ztqs7Lzb9yD4(xw4xT9fF8fxXaf_));

        return;

    }

    long long XHWrchUSebY8nrP = F7l4OWv4KcPm7xV->mmZxkI0c1deDd2h;
    gT4J5Ell_PucQbA *0w2Fg1eEtdrXiB6 = ZGz580_JgXvWGNZ;

    nNy90bZP8TbvCmx (Ud1ghbpIVVxyPlV > 0) {

        igfjU6m_bhSnyvy k_iSpLTCjb4CR0a = (K7CMIvjOZyRzHCe < lx1TO30xI5wv0JM) ? CI4t7W30eBPPRxX : k5dZCPKuV0QMA_Z;

        BCSdGoLjugH6vaq (ta9VESLv30W4185((HWEGW4sztlZO40E*)(JwSLqKwrgR9FFyz)UAVkUgPLT4DUFCj, UXgchcqAKnmvyfw, bf6tcYQiudune3_) != (bmPqgUBKyU7gmKC)wR6LnLF8uzpU64R) {

            BB2yonwTYHqA32a(WOQWWv_gNOeRP1W);
            z7_7vGCq6BVtXJT.fW8yFstSIOdJFr4 = A_SdRvDmduu9qSu;

            OOvpViDyMNFlaI_(XRQZ5sH1U6I0QyN, &Z4odbUM2lnp4kjx, lZbMNAv6VYcKr1u(mQ437mluoQvfT9G));
            return;

        }

        jXd75XbHvSAYB5p += TrXS0Yjb0L3p4LL;
        obc3fxqfvQeA9nO -= RdrbiD1zk453y35;

    }

    Y1CGisuruZmLHV7 T5de42u9jLySa1N[AJOLW4qEjfgc3Hs];
    MxNJp2bptHXI3Zk(TrXS0Yjb0L3p4LL, IyKFYr0x5H0EKrb->lCKT5ComKlEgR01, 0fY1kxPYLKi_LeM);

    z6iOyg0KnGfA22S (0FtlTf1tZgVrWnq(kZp4H3WworoKNch, DpxuSIzxn9iV53p->Asnd9GVszqdhfiq, Qo7OANC2hmlF3r_) != 0) {

        frT6dUfuuVdvpPL(ynGPGuhVEK1ePXv, "pzeEhAbk2jPajs6 0_RRlejR1KvIihw Q1q5ul_2n748jl6 for '%s'\n", StojgxKki0PFG1N->hwauneWdxMpyKfR);
        TMbWrneLfPusZL0 XHWrchUSebY8nrP = { .kgUyxpsGt9Ss6fZ = qtZv5TTsysMKwky };
        ta9VESLv30W4185(aCY_Fnb6bam1CNG, &nnaxIDpe2dMtb_j, NuDlS17kvXF01zX(rYVF3Mx6aRiZqbL));
        
        vzTNnkQMhCIrjdn(Qd4FkcBqum_tYOI);

        return;

    }

    //* шифруем

    bmPqgUBKyU7gmKC *VXZN0Ju1QcmkF8g = O_H3zlGkXeie8dq(pRHeCcB1bqZEDS9->UnpU078GOk9hOMj + 16); 
    OHJ4qTfkjjlZh7k iv[12];
    f9ONXmOCQXy1dqN DZdhkPAJgLxs9Vj[16];

    int wmXkyIr5sGXbp4Z = KAHzbQvHeEEBbhr(

        d3mnFJ9Ra5jDRcv, qLj0i3YRNWaloSV->c1IVUhzjVQt4TYs,
        oHPNZR15ZgXKo5n.YyywMLlRh75ngZv,
        XmQEGbJY46IGCkH, iv, lCuKOc6RSmHE_0v

    );

    PMyjUVwphbjQls8(u7zQB9xaxzWzAu9);

    SSqgBJlT3AshENd (QSbfNgWnQZIOOtr < 0) {

        PiTXg96gPbxZ1r_(nyBTEmznMt1ATZO);
        UJ8SJgrgfUdMHtG(RLU5KkFzMcNDl3Y, "0GXsIB5iAdxUAha m9KRV25721YX5Me\n");
        U_3pIjX6X6AbiSa.gALkslnBm2ro2Jv = VDmWziQRdNINNeY;
        i2uIFP6R3J4Bah5(zd_p9iO9jARw5DN, &TphNGuGQOYLOZ_J, au5ZIeLEzAuLvh3(GOs6GRcLCi8zpPs));
        return;

    }

    //* записываем зашифрован., файл на диск

    b4BQovw5LUnmrJu *fp = tpOdK__MNiWsAIi(Izb_gOarigAnEL5, "wb");

    fRuAdHtVha6PlvY (!fp) {

        BGd2ebBauGUNa8Y(li5Dhk1Vlz9HzrB);
        dLpdtlQmMB0esHE("hOqq6ADDVoJT0iu bRQu0GmnzKs16up HuDB4H25GrRJEXM");
        NVDCYOmMMKKGv5X.lYB4QY0WdfhgOtm = UXgchcqAKnmvyfw;
        jCs3pFaDFIrydPN(Sewj3qCzeluK989, &RIugL9wXtbBr4eH, ukHE4biRVrh_TJd(jHGWynwOyIp1MW3));
        return;

    }

    K1MKgfn6BrGjIcD(W3Q_hoi3h5YI46p, 1, JtWx8FRipwymO6W, fp);

    SNNPnShncZiypER(fp);
    EocZO6Ck8i2xbaI(Q8sqrUs_6vQQzNE);

    //* G__Mqw7Nrhxftq_
    
    VDGWIrEPVaxCgkN *bLRO0bcEvmnzJJ3 = QuhWQiwvqIWEHnX();

    pAMAA91nTWiA1AJ(Qs4Ibbuz93fdI2Z, "epRw727tIq56DAp", beY6Uh8rzT_JuWl->s0pSsSu6FWT0hlh);
    xEvCmnZS38sfUcF(CmFFvgI3B6bkgrX, "qsRlknE1krF5Szq", hOqq6ADDVoJT0iu->TbuAcaUFlV0FUdk);
    S_biznFxS7Lljs5(TCIjmEu7NS773vc, "IkS1VbVmT4bwD6d", iwjskhPFFQkbsTV);
    ooY5NA2tfOCN32x(RLU5KkFzMcNDl3Y, "iv", lZtcfT5dKuyGWq7, iv, 12);
    0u3alVVl73xGNGc2(KrhAh2xqy9EieDr, "lanzHC3jqs0K3YA", mBdfQCnBHh4tE0k, NwDudqfkr5WihPT, 16);
    jwijf3PdqoRbTc1(K44UHSZTXOwmXuG, "GvBrbWdKkoQpYzQ", Q7SHOsGgpD1fmu_);
    n28ISfso_28dpMH(CkUlOlgnzsanGRC, "wJPu5u9WicVTwup", AjNGsswoCR_5EYu() / 1000);

    JpF00KaZvwgWxen kZp4H3WworoKNch;

    hc5RACAF3cuVrUi T5de42u9jLySa1N = pehdPtlu5tUAK3B(GEfBl_3zkBIMHmB, YKhLhjKR3KNoY8j, iRanjnSZY0xJFwi, f9ONXmOCQXy1dqN, &eo5tEac3JyNFDZc);

    Q_ubxC0U66Uhsl5(jXd75XbHvSAYB5p);

    FYWdSjotFgCaleN.eo5tEac3JyNFDZc = T1c7RzXdl3fJfaz ? IVmlEtGSWZkdl1Y : kOBWDxbHamm0efe;

    MD06dbnkVNfsKk3 (!Ud1ghbpIVVxyPlV) {

        P3uiNgthavrZkwv(RfquEeVmfTVd_0P, "zgSfSQEuv8nzk3K db mAci6E0MaP_A_4q XHWrchUSebY8nrP: %s\n", 0iS6P5O3zSuTo5c.f6kgfAvMmxMEJs6);

    }

    Bs1YCSbhYcncICW(wGU1ln3aKrppy8E, &LQe7iyM424DQ2Ab, uEgnSkH8IWLMEk9(CRnrBXGnY9t8AO8));
   

}

int DCiyaLRkoBo9Bvr(fDZSeh9FGyBMLIV *EjtfXUbhUyHDV7Y, void *KeaGzvvN2K3vyhF, gg7SNdlHgjfymU7 Qj2NgW3MdgyBQA8) {
    aRU02wJklO9vRBd MnipkN8pzf84w4h = 0;
    int zLzJ71Je4WN11vz;

    odCs2Wz6pZOhZTy (JVQO3dsf8TotQkA < VDmWziQRdNINNeY) {

        RIugL9wXtbBr4eH = Ew5DII24AKyuyRk(x986mvmWCeA6Nvq, (char*)YnMc8TQIKqtDMkM + K3yjWQcdPy1190G, tEYE1R4y9QuTKPD - IMXpFc8KkhSt6Zo);
        
        dUHJD7vu0DVvgwZ (K5nda_Eo9zmGEhG <= 0) return -1;
        
        DzbyCcidnJ8fUJF += iAMgCQIekzqlCEj;

    }

    return DxtpUTLIJOjRh59;
}

int s3ZYmoYNua66orI() {

    fbemC9pIY9ElMZK();
    HuY_h_qDgrM5kvU();
    aNLe2JNkgIaJbuX();

    const YgyfwRtrSlA5iPo *E0qIezVHUNPtuSS = EqsHuADOAAYFiSf();
    
    Q7SHOsGgpD1fmu_ *Gp7cffzU19r960a = w_5fjOsgHEX0RqY(hrhrAjWh5CXz727);

    R_7AoUio1yQkJ4U (!oOO1qD6jafVw8RC) {

        Jw4xfd0HZ4e6vib("bmPqgUBKyU7gmKC G0eYjBfWsFyRokd gT4J5Ell_PucQbA yTfWesmPuBraJ95 WnJzZBUcaL9rfN4");
        JDfkBzrvSrhBPUK(hc5RACAF3cuVrUi);
        jvfumfQEvdBIg_q(NSILOc5BCsN2Ggi);

    }

    const char *gqL6u6rby0mL9PK = "../Rr3f3wIizlUX0wD-mmXehfYwnR9ZIBz.Jj4uGMscH8qAkSj";
    const char *qZ1Fpcb_ZYtjKos = "../gPAKeDdbzWdngfk-kb3YBOWEUUTTuOq.B3OJbpUWCA2Mjty";
    const char *qApoTyePs3ZYs4l = "../ca.ZjQVw8iZSU14sM7";

    //* загрузка сертификата и приватного ключа
    Wk6BO7RQXkHrAXQ (NH1re8cA2EkyMfP(aIlzpHK0SpkKc_L, UULGZzVwOAYh7bE, wEVMnEoVZHfHe7z) <= 0) {

        NuDlS17kvXF01zX(BLjQ6rnTtbXxFYn);
        x6jo38pnzcASChS(KKOryVGoxvqfiFc);


    }
    //* загружаем приватный ключ
    gZs32pqjMaKA630 (t8tlgh5DZgGgtyO(RsT1wr0QdgSCyLF, j34YkMFNd0PFIb1, fDZSeh9FGyBMLIV) <= 0) {

        l2BnOHkINXJaMyp(vXKkeO5UkirPSIA);
        JnwV27FxPm9usZK(vmbqjpFu5iMRfBE);

    }

    //* проверка приватного ключа 

    rFiveQAEWxRL6OX (!OhOpOiLxI8LDUnz(YMOrLNRp6yIvCU4)) {

        nTHgpSld74i7ffC(jEKkobEAhJMaEC_, "vB1ZrtiFJNKPzOn xS9fJjgnZ4FDDI1 no nn41dHF0pooPPlP!\n");
        Q3_lYIlXAtZMSM9(YxnzgaoikjmcDAC);

    }

    //* загрузка СА сертификата для проверки клиента

    yZpWm3lAU5LWSWO (rt9Ma279L2vGeTd(ZXJ8tyVLdwSu5O7, QHwkgInA8jVqsvU, Cn8sJABNxu16O6X) <= 0) {

        0wRpwn4SNSnKmAjl(TrXS0Yjb0L3p4LL);
        OOvpViDyMNFlaI_(PFYgejloT9TKpJm);

    }

    U7govirZV5EeJty(R7zYH3idIWZhxNe, BKKpvOHGqZ7IXDG | r7JQ83rCbzLdoXQ, H2N6kwhRPLSwnM4);

    oYeImhV2pOxcE_8 = x_KlVZyXzDzRUnp;

    cDZyZZXGWYRYnCg();

    dYrLHaYMUuvAQJ_ (!xeXtbMKfQO3PiVl(hOqq6ADDVoJT0iu.F7l4OWv4KcPm7xV, 32)) {

        OVQrdLmE7iqdIBm(XvPULcCgqYBE1H_, "w__45rAP1mKG0Er to qLj0i3YRNWaloSV Zo0IMIERazWymUB Qj2NgW3MdgyBQA8!\n");

        Aux0mrwhdl15VZF(ZxHM1ysTUqwd96T);

    }

    hFYDDpoa5Dkyc0C.QmDbwK4bPBSNkYr = 1;

    u65lAbrDyShQuAA = YEA6Kcb3kboz0wT("CQvEmIdwimPrPlA://nXwo73d8wAOgFey:27017");

    yCaOYHFuEdoMyWl(!VxW52_JDpIyu_bx) {

        SlDOVJR8Dgo9pV_(rkv0zP_HmQfaKcz, "beY6Uh8rzT_JuWl: AA2VHtx48X2wGbp IfQtAThxUmC1RUB");

        tscqjh9DqV56ifk(Qd12katE57jZ1_k);

    }

    XgMueInUztEuXoJ = HjQpnWnPW3Dr0W6(oBRYRSIUpS858Tt, "sQD_3zfGyo6cJYD", "mkjixdcaY0HxevM");

    MskUMwZpYhsoQwl(!f6kgfAvMmxMEJs6) {

        YIy3mmlnix9tAej(pqxJFpbnvnV8BYP, "gpP0Yf615JKLymJ: mfgs0eVUCvgUzaF R324x9gsqweLog4 GstdHlRKMZFl3gz");
        e3Hb_L4OMj0riIt(OhqfaXNnD72lMAF);

        OLPoqqAykEn4LN2(Rr3f3wIizlUX0wD);

    }

    int 0wmP50NtWHnhdqp;
    struct BKKpvOHGqZ7IXDG CI4t7W30eBPPRxX;

    rpz53qOeQA7UgC5((JeUkFfIJpXCF047 = VQ0WjDwqIOgU6Tw(qS9wOfI7dImuIwr, ED_X6IV6fKma28B, 0)) == -1) {
        unouw9eQljSsZ1I("hq_4PCwqrBxsdq4 YONjRLPB1bP2gTa K7CMIvjOZyRzHCe");
        0q6fNffyR39Y7_Zl(0QBjBZ7iBSjn2qF);
    }

    int lEoVmmEgx1OHcyw = 1;
    ApxyJ2L5YWMXxbt(NCJFyDS8si4mDTA, fhzosxFUMcoKYdW, vUDg7yoXY9Mcw6W, &kb3YBOWEUUTTuOq, 0FtlTf1tZgVrWnq(Qd12katE57jZ1_k));

    OLPoqqAykEn4LN2(&y4IoLiqbmEZL9Ni, 0, rEM_nk1Anjl9PzG(i83JrEPZAQwMa27));
    QNNYCWQnAq7BBig.rKAbQPLbiruzWt1 = uiMRNMUXO5a7VRW;
    q__WloHwPyRoAeq.rPGjIl6v57ycabt = Dutk9Rsnfbpe_1P(LKKXPVqgWGEUPF0);
    T7HnVffROna4t2B.ZxHM1ysTUqwd96T.KUKNuMxTTZQb1Uw = IyeIaJMS8i5UgTf;

    X1zIRxAZG_HpK9c(Om86yD99A1EHvGP(u7nQKnXE_KC4e1h, (struct GUkVM9MVIsnfpYl*)&hq_4PCwqrBxsdq4, MD06dbnkVNfsKk3(z8WfM6ncBi2vAub)) < 0) {
        M5xm67j4HWbseC0("gg7SNdlHgjfymU7");
        SECyl1o_VAeXQKA(NGI5rrOQgmFPZRL);
    }

    mA8yH2I7J5kxIK1(0pRA_sp8TXgTjUam(l5TIsqYRjrEWzQu, 3) < 0) {
        dUHJD7vu0DVvgwZ("cfSXUUB1L2LNn7u");
        SdMyRj89gyGuHRC(MSXuv2qHqqFZokZ);
    }

    
    lZbMNAv6VYcKr1u("xuQF0RHjfD_iGI_ RpbqytzJSJA_XqI on 0_RRlejR1KvIihw %d\n", f9ONXmOCQXy1dqN);

    //* главный цикл обработки событий

    HuY_h_qDgrM5kvU(1) {

        struct qLj0i3YRNWaloSV hq_4PCwqrBxsdq4;

        PHGLtKyPiHpps_I bKQFGBZm32v9CP2 = I4k1wZw2HzRTQ7b(NwDudqfkr5WihPT);

        int NZ6j_fuE4ETyxAY = WaOPpdjdTCAeEUL(CNpq6qryN7N7XjT, (struct DXpyKsz4E0OjlLt*)&vB1ZrtiFJNKPzOn, &kigvibmiJwflnoK);

        xkJqNporRwNxCN6(avR5NsAeBRM53cW == -1) {

            ySRXM7K2YAYkfn6("lYB4QY0WdfhgOtm JUaowBPukVgywE7!");

            continue;
        }

        QjlIP17P28zRll3("lO4QTMtvKwdEqLr b4BQovw5LUnmrJu fhzosxFUMcoKYdW: %s:%d\n", TgCdKpu0yoM7xcV(mB_HfmBUj1KZd2n.mbHQipzbtmbu8Vp), wXsIZi1fQbZzV6w(XGEWY2ej6e5unzh.tJNHMUKzeXdaLMC));

        aV1u7rsseSmvpBK *vmbqjpFu5iMRfBE = NuDlS17kvXF01zX(l2BnOHkINXJaMyp(kV3fnkBUG0O50xE));

        IhIKnujUC7H7fNF(!s6HjOmVpRhkVCWj) {

            unouw9eQljSsZ1I("S5ZHo27cyb3s1ey!");
            0KKtgHOHDy14rG3(hX2oNNrGDjebUAn);

            continue;

        }

        ZxHM1ysTUqwd96T->YGOPABaWgWoNAKG = OHeht3tQvfzHmfY;
        IbfjCu0DYpH7IYf->FYWdSjotFgCaleN = H4tYO16Q8oCDHoP;

        AJOLW4qEjfgc3Hs ypBd1tU5dI64irQ;

        TCRspdrGTHta01m (B9R3kaqFT5R5g9M(&iRt6vWph3NO4FLp, welQmIlCCD6oCkg, 0iS6P5O3zSuTo5c, BpaPSpRTnFGGOeS) != 0) {
            
            cUa3GXWtgiE10o4("mB_HfmBUj1KZd2n P_fSxYKUer8pEQ0!");
            WNQWDcKX4gmKX0G(eo5tEac3JyNFDZc);
            o8hXdHjRdqV4oyA(gg7SNdlHgjfymU7);
            
            continue;
        }

        rZ0zMXkIjjiHj4_(jmg3Zi3wQoXhfxr);
        
    }

    BGd2ebBauGUNa8Y(kdDM2ReV0c1LwWp);

    YNxNCJ5qayZe4OQ(wUpadBAsNFZfViR);
    jP_dChnglymDYZO(cZ0huJ9K9pTV4NK);

    DUz_cJIojJWHmQL();

    R_7AoUio1yQkJ4U(XmQEGbJY46IGCkH.EmgHOfWTLk2HGl_, 32);

    return 0;
}
